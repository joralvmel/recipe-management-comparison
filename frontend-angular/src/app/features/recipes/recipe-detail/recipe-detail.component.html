<div class="recipe-container">
  <app-loader
    *ngIf="isLoading"
    message="Loading recipe details..."
    size="large">
  </app-loader>

  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
  </div>

  <div *ngIf="!isLoading && !error && recipe" class="recipe-detail">
    <app-recipe-header
      [title]="recipe.title"
      [recipeId]="recipeId"
      [isFavorite]="isFavorite"
      [isAuthenticated]="isAuthenticated"
      [isLoadingFavorite]="isLoadingFavorite()"
      (toggleFavorite)="toggleFavorite($event)">
    </app-recipe-header>

    <app-recipe-main-section
      [imageUrl]="recipe.image"
      [title]="recipe.title">
    </app-recipe-main-section>

    <app-recipe-section
      [ingredients]="recipe.extendedIngredients"
      [servings]="servings"
      [originalServings]="originalServings"
      [readyInMinutes]="recipe.readyInMinutes"
      [healthScore]="recipe.healthScore"
      [cuisines]="recipe.cuisines"
      [dishTypes]="recipe.dishTypes"
      [diets]="recipe.diets"
      [instructions]="recipe.analyzedInstructions">
    </app-recipe-section>

    <app-review-section
      *ngIf="(reviews && reviews.length > 0) || isAuthenticated"
      [reviews]="reviews"
      [recipeId]="recipeId"
      [isAuthenticated]="isAuthenticated"
      [currentUserId]="currentUserId"
      [hasUserReview]="hasUserReview"
      [userReview]="userReview"
      [reviewRating]="reviewRating"
      [reviewComment]="reviewComment"
      [submittingReview]="submittingReview"
      [editingReviewId]="editingReviewId"
      [editRating]="editRating"
      [editComment]="editComment"
      (submitReview)="onSubmitReview($event)"
      (startEditing)="onStartEditing($event)"
      (cancelEditing)="onCancelEditing()"
      (saveReview)="onSaveReview($event)">
    </app-review-section>
  </div>
</div>
